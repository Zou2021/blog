<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org" xmlns="http://www.w3.org/1999/html">
<div th:replace="themes/pinghsu/header::header(title='å…³äº',keywords=null)"></div>
<body>
<article class="main-content page-page">
    <div id="post-content" class="post-content">
        <i class="app-menu__icon fa fa-user"></i>&emsp;åŸºæœ¬ä¿¡æ¯
        <blockquote>
            <ul>
                <li>ç«™é•¿åç§°ï¼š<span th:text="${options['blog_name']}"></span></li>
                <li>ç½‘ç«™åœ°å€ï¼š<a href="https://www.hqxiaozou.top" target="_blank"><span
                        th:text="${options['blog_url']}"></span></a></li>
                <li>ç«™é•¿é‚®ç®±ï¼š<span th:text="${options['email_username']}"></span></li>
            </ul>
        </blockquote>
        <i class="app-menu__icon fa fa-link"></i>&emsp;å‹æƒ…é“¾æ¥
        <!--        <a th:href="@{map}" style="float: right;margin-right: 45px" target="_blank">-->
        <!--            <button class="mini ui orange basic button">ç–«æƒ…åœ°å›¾</button>-->
        <!--        </a>-->
        <a href="https://www.hqxiaozou.top/static/game.html" style="float: right;margin-right: 45px" target="_blank">
            <button class="mini ui orange basic button">ç‹¼äº†ä¸ªç‹¼</button>
        </a>
        <a th:href="@{proverbs}" style="float: right;margin-right: 20px" target="_blank">
            <button class="mini ui teal basic button">æŸ¥çœ‹</button>
        </a>
        <ul class="flinks">
            <th:block>
                <!--                <a class="avatar" href="https://wch666.com/" target="_blank">-->
                <!--                    <img src="https://wch666.com//index.ico">-->
                <!--                </a>-->
                <li>
                    âœŒ <a href="https://zou2021.github.io/resume/static/image/weixin.png"
                         target="_blank">ç«™é•¿å¾®ä¿¡</a>
                </li>
                <li>
                    â¤ï¸ <a th:href="@{baby}" target="_blank">çªçªä¸“å±</a>
                </li>
                <li>
                    ğŸ‰ <a th:href="@{fireworks}" target="_blank">ç‚¹æˆ‘è¯•è¯•</a>
                </li>
                <!--                <li>-->
                <!--                    &#128175; <a href="https://zou2021.github.io/resume/" target="_blank">ä¸ªäººç®€å†</a>-->
                <!--                </li>-->
            </th:block>
        </ul>
        <i class="app-menu__icon fa fa-comments"></i>&emsp;ç•™è¨€æ¿
        <!--é¡µé¢åµŒå…¥è§†é¢‘-->
        <!--src="https://live.csdn.net/v/embed/267834"-->
        <iframe frameborder="0" allowfullscreen="1"
                allow="accelerometer; autoplay; encrypted-media; gyroscope"
                title="lol video player" width="100%" height="100%"
                src="http://niu.hqxiaozou.top/thresh"
                style="padding-top: 20px">
        </iframe>
        <iframe width=0 height=0 frameborder=0 id="myiframe" name="myiframe"></iframe>
        <!-- è¡¨å•æäº¤åŒº -->
        <form target="myiframe">
            <input type="hidden" name="blogid" value="1"/>
            <input type="hidden" name="blogUrl" value="about"/>
            <input type="hidden" name="parentCommentId" value="-1">
            <div id="comment-form" class="ui form">
                <div class="field">
                    <textarea id="aaa" name="content" placeholder="è¾“å…¥å›¾ç‰‡åœ°å€æäº¤åå¯ç›´æ¥åœ¨ç•™è¨€åˆ—è¡¨æ˜¾ç¤º~"
                              required="required"></textarea>
                </div>
                <div class="fields">
                    <div class="field m-mobile-wide m-margin-bottom-small">
                        <div class="ui left icon input">
                            <img id="avatar" src="https://q1.qlogo.cn/g?b=qq&nk=1565453341&s=100"
                                 class="ui mini circular image" style="margin-top: 11px">
                        </div>
                    </div>
                    <div class="field m-mobile-wide m-margin-bottom-small" style="padding-top: 10px">
                        <div class="ui left icon input">
                            <i class="qq icon"></i>
                            <input type="text" id="QQ" name="qq" placeholder="è¾“å…¥QQå·è‡ªåŠ¨è·å–æ˜µç§°å¤´åƒ"
                                   required="required"/>
                        </div>
                    </div>
                    <div class="field m-mobile-wide m-margin-bottom-small" style="padding-top: 10px">
                        <div class="ui left icon input">
                            <i class="user icon"></i>
                            <input type="text" id="nickname" name="nickname" placeholder="æ˜µç§°"
                                   required="required"/>
                        </div>
                    </div>
                    <div class="field m-mobile-wide m-margin-bottom-small" style="padding-top: 10px">
                        <div class="ui left icon input">
                            <!--                            <i class="mail icon"></i>-->
                            <input type="text" id="ccc" name="email" placeholder="é‚®ç®±"
                                   hidden="hidden" required="required">
                        </div>
                    </div>
                    <div class="field m-margin-bottom-small m-mobile-wide" style="padding-top: 10px">
                        <button id="comment-btn" type="submit" class="ui violet button m-mobile-wide "><i
                                class="edit icon"></i>å‘å¸ƒ
                        </button>
                    </div>
                </div>
            </div>
        </form>
        <!-- è¯„è®ºåˆ—è¡¨ -->
        <div id="comment-container" class="ui teal segment">
            <div th:fragment="commentList">
                <div class="ui threaded comments" style="max-width: 100%">
                    <span><i class="app-menu__icon fa fa-commenting"></i>&nbsp;
                        <th:block th:text="${commentCount}"></th:block>
                        æ¡ç•™è¨€
                    </span>
                    <div class="comment" th:each="comment : ${comments}">
                        <a class="avatar">
                            <img th:src="@{${comment.avatar}}">
                        </a>
                        <div class="content">
                            <a class="author">
                                <span th:text="${comment.nickname}"></span>
                                <a class="ui teal mini tag label m-padded-tb-tiny"
                                   th:if="${comment.avatar}=='https://img-blog.csdnimg.cn/a4e106d8f8934ad397f852ebfeba8c55.png'">åšä¸»</a>
                                <a class="ui teal mini tag label m-padded-tb-tiny"
                                   th:if="${comment.avatar}=='https://img-blog.csdnimg.cn/0381d4b0e4234286a4c7d6cb45d1701f.bmp'">blogger's
                                    baby</a>
                            </a>
                            <div class="metadata">
                                <span class="author" style="color: #1b95e0"
                                      th:if="${comment.sort}<=0">ç½®é¡¶</span>
                                <span class="date"
                                      th:text="${#dates.format(comment.createTime, 'yyyy-MM-dd HH:mm')}"></span>
                            </div>
                            &nbsp;
                            <span th:text="'æ¥è‡ª'+${#strings.substring(comment.province,0,2)}"
                                  style="color: darkgray"></span>
                            <div class="text">
                                <p style="white-space: pre-wrap; background:#fafafa repeating-linear-gradient(-45deg,#fff,#fff 1.125rem,transparent 1.125rem,transparent 2.25rem);box-shadow:0 2px 5px rgba(0,0,0,.15);margin:20px 0;padding:15px;border-radius:5px;font-size:14px;color:#555"
                                   th:utext="${comment.content}"></p>
                            </div>
                            <div class="actions">
                                <a class="reply" data-commentid="1" data-commentnickname="zou"
                                   th:attr="data-commentid=${comment.id}, data-commentnickname=${comment.nickname}"
                                   onclick="reply(this)">
                                    <button class="mini ui teal basic circular button">å›å¤</button>
                                </a>
                            </div>
                        </div>
                        <div class="comments" th:if="${#arrays.length(comment.replyComments)} gt 0">
                            <div class="comment" th:each="reply : ${comment.replyComments}">
                                <a class="avatar">
                                    <img th:src="@{${reply.avatar}}">
                                </a>
                                <div class="content">
                                    <a class="author">
                                        <span th:text="${reply.nickname}"></span>
                                    </a>
                                    <span> @ </span>
                                    <a class="author" style="color: teal">
                                        <span th:text="|${reply.parentName}|"></span>
                                    </a>
                                    <div class="metadata">
                                        <span class="date"
                                              th:text="${#dates.format(reply.createTime, 'yyyy-MM-dd HH:mm')}"></span>
                                    </div>
                                    &nbsp;
                                    <span th:text="'æ¥è‡ª'+${#strings.substring(reply.province,0,2)}"
                                          style="color: darkgray"></span>
                                    <div class="text">
                                        <p style="white-space: pre-wrap; background:#fafafa repeating-linear-gradient(-45deg,#fff,#fff 1.125rem,transparent 1.125rem,transparent 2.25rem);box-shadow:0 2px 5px rgba(0,0,0,.15);margin:20px 0;padding:15px;border-radius:5px;font-size:14px;color:#555"
                                           th:utext="${reply.content}"></p>
                                    </div>
                                    <div class="actions">
                                        <a class="reply" data-commentid="1" data-commentnickname="zou"
                                           th:attr="data-commentid=${reply.id}, data-commentnickname=${reply.nickname}"
                                           onclick="reply(this)">
                                            <button class="mini ui teal basic circular button">å›å¤</button>
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</article>
<!--éŸ³ä¹æ’­æ”¾å™¨-->
<meting-js
        server="netease"
        type="playlist"
        id="19723756"
        mini="true"
        fixed="true">
</meting-js>
</body>
<div th:replace="themes/pinghsu/footer::footer"></div>
<script type="application/javascript">
    <!--æ ¹æ®QQè‡ªåŠ¨è·å–å¤´åƒä¿¡æ¯-->
    $('#QQ').blur(function () {
        var QQ = $("#QQ").val();
        $.ajax({
            url: "https://api.usuuu.com/qq/" + QQ,
            type: "GET",
            dataType: "json",
            success: function (result) {
                console.log(result["data"].name, result["data"].avatar);
                $("#nickname").val(result["data"].name);
                var obj = document.getElementById("avatar");
                obj.src = result["data"].avatar;
                $("#avatar").val(result["data"].avatar);
                $("[name='email']").val(QQ + '@qq.com');
            }
        });
    });

    //å›å¤
    var reply1;
    var replyCommentId = 0;

    function reply(obj) {
        let commentId = $(obj).data('commentid');
        let commentNickname = $(obj).data('commentnickname');
        reply1 = commentNickname;
        replyCommentId = commentId;
        //æ·»åŠ ä¿¡æ¯åˆ°è¯„è®ºè¡¨å•
        $("[name='content']").attr("placeholder", "@" + commentNickname).focus();
        $("[name='parentCommentId']").val(commentId);
        //æ»šåŠ¨åˆ°è¯„è®ºè¡¨å•
        $(window).scrollTo($('#comment-form'), 500);
    }

    //ç‚¹å‡»å›¾ç‰‡æŸ¥çœ‹å¤§å›¾
    const img = document.images;
    for (let i = 0; i < img.length; i++) {
        if (img[i].src !== "https://wch666.com//index.ico") {
            $(img[i]).bind("click", function () {
                //æ–°å¼€ä¸€ä¸ªé¡µé¢
                window.open($(this).attr('src'), '_blank');
                // window.location.href = $(this).attr('src');
            });
        }
    }

    $(function () {
        $('#comment-btn').click(function () {
            var blogid = $("input[name='blogid']").val().trim();
            var blogUrl = $("input[name='blogUrl']").val().trim();
            var tem = $("textarea[name='content']").val().trim();
            let url = "<img src=" + tem + ">"
            if (tem.startsWith("http://") || tem.startsWith("https://")) {
                var content = url;
            } else {
                content = tem;
            }
            var nickname = $("input[name='nickname']").val().trim();
            var email = $("input[name='email']").val().trim();
            var avatar = $("#avatar").val();
            var parentId = $("input[name='parentCommentId']").val();
            if (reply1 != null) {
                var parentName = reply1;
            } else {
                parentName = nickname;
            }
            var data = {
                blogid: blogid,
                blogUrl: blogUrl,
                content: content,
                nickname: nickname,
                email: email,
                avatar: avatar,
                parentId: parentId,
                parentName: parentName,
                parentCommentId: replyCommentId
            };
            if (content !== "" && content !== null && content !== undefined && nickname !== "" && nickname !== null && nickname !== undefined) {
                //éªŒè¯é‚®ç®±æ ¼å¼
                const emailReg = /^([A-Za-z0-9_\-\.])+\@([A-Za-z0-9_\-\.])+\.([A-Za-z]{2,4})$/;
                if (!emailReg.test(email)) {
                    alert('é‚®ç®±æ ¼å¼é”™è¯¯');
                    return;
                }
                $.ajax({
                    type: "POST",
                    url: '/comments',
                    data: data,
                    dataType: 'json',
                    contentType: 'application/x-www-form-urlencoded',
                    success: function (req) {
                        console.log(req)
                    },
                    error: function (e) {
                        console.log(e)
                    }
                })
                alert('æ‚¨çš„è¯„è®ºå·²æˆåŠŸæŠ•é€’è‡³å¬ç”°æœ€å¸…boyï¼Œè¯·è€å¿ƒç­‰å¾…ä»–å®¡æ ¸å§ï¼');
                $('#aaa').val('');
                //ä¸€ç§’ååˆ·æ–°é¡µé¢
                // setTimeout('location.reload()', 100);
            } else {
                alert("æ˜µç§°å’Œè¯„è®ºå†…å®¹ä¸èƒ½ä¸ºç©ºï¼")
                return;
            }
        })
    })
</script>
</html>